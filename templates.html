<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Templates - PickWEB</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="container nav-container">
                <a href="index.html" class="logo">PickWEB</a>
                <div class="menu-toggle" id="mobile-menu">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
                <ul class="nav-menu">
                    <li><a href="index.html" class="nav-link">Home</a></li>
                    <li><a href="about.html" class="nav-link">About</a></li>
                    <li><a href="templates.html" class="nav-link active">Templates</a></li>
                    <li><a href="contact.html" class="nav-link">Contact</a></li>
                </ul>
            </div>
        </nav>
        <div class="hero">
            <div class="container">
                <h1>Our Templates</h1>
                <p>Browse our collection of beautiful, responsive templates</p>
            </div>
        </div>
    </header>

    <main class="section">
        <div class="container">
            <div class="filters">
                <button class="filter-btn active" data-filter="all">All Templates</button>
                <button class="filter-btn" data-filter="portfolio">Portfolio</button>
                <button class="filter-btn" data-filter="restaurant">Restaurant</button>
                <button class="filter-btn" data-filter="textile">Textile</button>
            </div>

            <div class="templates-container" id="templatesContainer">
                <!-- Templates will be loaded here by JavaScript -->
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>About PickWEB</h3>
                    <p>Your one-stop destination for high-quality website templates. Create stunning websites quickly and easily.</p>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="templates.html">Templates</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact Us</h3>
                    <p><i class="fas fa-envelope"></i> contact@pickweb.com</p>
                    <p><i class="fas fa-phone"></i> +1 (555) 123-4567</p>
                    <div class="social-links">
                        <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 PickWEB. All rights reserved. | <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a></p>
            </div>
        </div>
    </footer>

    <!-- Modal for template preview -->
    <div id="previewModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div class="preview-container">
                <iframe id="templateFrame" src="" frameborder="0"></iframe>
            </div>
            <div class="preview-actions">
                <button id="downloadBtn" class="btn btn-download" data-template-path="" data-template-name="">
                    <i class="fas fa-download"></i> Download
                </button>
                <button id="closePreviewBtn" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <script src="js/script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Mobile menu toggle functionality
            const mobileMenu = document.getElementById('mobile-menu');
            const navMenu = document.querySelector('.nav-menu');
            const navLinks = document.querySelectorAll('.nav-link');
            const filterButtons = document.querySelectorAll('.filter-btn');
            const templatesContainer = document.getElementById('templatesContainer');
            const modal = document.getElementById('previewModal');
            const closeBtn = document.getElementById('closePreviewBtn');
            const viewLiveBtn = document.getElementById('viewLiveBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const templateFrame = document.getElementById('templateFrame');
            
            // Initialize template data (same as in script.js)
            const templates = [];
            
            // Generate portfolio templates (1-28)
            for (let i = 1; i <= 28; i++) {
                templates.push({
                    id: `portfolio-${i}`,
                    name: `Portfolio ${i}`,
                    category: 'portfolio',
                    path: `Portfolio_${i}/index.html`,
                    thumbnail: `Portfolio_${i}/image.png`
                });
            }
            
            // Generate restaurant templates (1-6)
            for (let i = 1; i <= 6; i++) {
                templates.push({
                    id: `restaurant-${i}`,
                    name: `Restaurant ${i}`,
                    category: 'restaurant',
                    path: `Resturant_template_${i}/index.html`,
                    thumbnail: `Resturant_template_${i}/image.png`
                });
            }
            
            // Generate textile templates (1-2)
            for (let i = 1; i <= 2; i++) {
                templates.push({
                    id: `textile-${i}`,
                    name: `Textile ${i}`,
                    category: 'textile',
                    path: `Textile_template_${i}/index.html`,
                    thumbnail: `Textile_template_${i}/image.png`
                });
            }

            // Display templates
            function displayTemplates(filter = 'all') {
                templatesContainer.innerHTML = '';
                
                const filteredTemplates = filter === 'all' 
                    ? templates 
                    : templates.filter(template => template.category === filter);
                
                filteredTemplates.forEach(template => {
                    const templateCard = document.createElement('div');
                    templateCard.className = 'template-card';
                    templateCard.dataset.category = template.category;
                    
                    const previewDiv = document.createElement('div');
                    previewDiv.className = 'template-preview';
                    
                    // Create container for the iframe with overlay
                    const previewContainer = document.createElement('div');
                    previewContainer.className = 'template-iframe-container';
                    previewContainer.style.position = 'relative';
                    previewContainer.style.width = '100%';
                    previewContainer.style.height = '100%';
                    previewContainer.style.overflow = 'hidden';
                    previewContainer.style.position = 'relative';
                    previewContainer.style.width = '100%';
                    previewContainer.style.height = '0';
                    previewContainer.style.paddingBottom = '75%'; // 4:3 aspect ratio
                    previewContainer.style.borderRadius = '8px 8px 0 0';
                    
                    // Create iframe for web preview
                    const iframe = document.createElement('iframe');
                    iframe.src = template.path;
                    iframe.style.width = '100%';
                    iframe.style.height = '100%';
                    iframe.style.border = 'none';
                    // Scale the iframe to be larger in the preview
                    iframe.style.transform = 'scale(0.5)';
                    // Center the scaled iframe in the container
                    iframe.style.transformOrigin = 'top left';
                    iframe.style.position = 'absolute';
                    iframe.style.top = '0';
                    iframe.style.left = '0';
                    iframe.style.width = '200%';
                    iframe.style.height = '200%';
                    iframe.style.pointerEvents = 'none'; // Disable interaction with the iframe
                    
                    // Add loading overlay
                    const loadingOverlay = document.createElement('div');
                    loadingOverlay.className = 'loading-overlay';
                    loadingOverlay.style.position = 'absolute';
                    loadingOverlay.style.top = '0';
                    loadingOverlay.style.left = '0';
                    loadingOverlay.style.width = '100%';
                    loadingOverlay.style.height = '100%';
                    loadingOverlay.style.display = 'flex';
                    loadingOverlay.style.justifyContent = 'center';
                    loadingOverlay.style.alignItems = 'center';
                    loadingOverlay.style.backgroundColor = 'rgba(255, 255, 255, 0.8)';
                    loadingOverlay.innerHTML = '<div class="spinner"></div>';
                    
                    // When iframe loads, remove the loading overlay
                    iframe.onload = function() {
                        loadingOverlay.style.display = 'none';
                    };
                    
                    // If iframe fails to load, show error
                    iframe.onerror = function() {
                        loadingOverlay.innerHTML = 'Preview not available';
                        loadingOverlay.style.backgroundColor = '#f8f9fa';
                    };
                    
                    previewContainer.appendChild(iframe);
                    previewContainer.appendChild(loadingOverlay);
                    previewDiv.appendChild(previewContainer);
                    
                    const infoDiv = document.createElement('div');
                    infoDiv.className = 'template-info';
                    
                    const title = document.createElement('h3');
                    title.textContent = template.name;
                    
                    const categorySpan = document.createElement('span');
                    categorySpan.className = `template-category category-${template.category}`;
                    categorySpan.textContent = template.category.charAt(0).toUpperCase() + template.category.slice(1);
                    infoDiv.appendChild(title);
                    infoDiv.appendChild(categorySpan);
                    templateCard.appendChild(previewDiv);
                    templateCard.appendChild(infoDiv);
                    
                    // Add click handler for preview
                    templateCard.addEventListener('click', () => openModal(template));
                    
                    templatesContainer.appendChild(templateCard);
                });
            }
            
            // Open modal with template preview
            function openModal(template) {
                if (!modal || !template || !template.path) {
                    console.error('Modal element or template data is missing');
                    return;
                }
                
                try {
                    modal.style.display = 'block';
                    
                    // Safely set template frame source
                    if (templateFrame) {
                        templateFrame.src = template.path;
                    }
                    
                    // Safely set view live button href
                    if (viewLiveBtn) {
                        viewLiveBtn.href = template.path;
                    }
                    
                    // Safely set download button attributes
                    if (downloadBtn) {
                        downloadBtn.setAttribute('data-template-path', template.path);
                        downloadBtn.setAttribute('data-template-name', template.name || 'template');
                    }
                    
                    document.body.style.overflow = 'hidden';
                } catch (e) {
                    console.error('Error opening modal:', e);
                    if (modal) modal.style.display = 'none';
                }
            }
            
            // Close modal
            function closeModal() {
                try {
                    if (modal) {
                        modal.style.display = 'none';
                    }
                    if (templateFrame) {
                        templateFrame.src = '';
                    }
                    document.body.style.overflow = '';
                } catch (e) {
                    console.error('Error closing modal:', e);
                }
            }
            
            // Event listeners
            mobileMenu.addEventListener('click', function() {
                mobileMenu.classList.toggle('active');
                navMenu.classList.toggle('active');
            });

            navLinks.forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.remove('active');
                    navMenu.classList.remove('active');
                    navLinks.forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                });
            });
            
            // Filter buttons
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    displayTemplates(button.dataset.filter);
                });
            });
            
            // Close modal when clicking the close button
            closeBtn.addEventListener('click', closeModal);
            
            // Close modal when clicking outside the modal content
            window.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });
            
            // Download button functionality
            downloadBtn.addEventListener('click', function() {
                const templatePath = this.getAttribute('data-template-path');
                const templateName = this.getAttribute('data-template-name');
                if (templatePath) {
                    // This would be replaced with actual download logic
                    alert(`Downloading ${templateName}...`);
                    // For actual implementation, you would need server-side code to handle the download
                    // window.location.href = `/download?path=${encodeURIComponent(templatePath)}`;
                }
            });
            
            // Initialize the page
            displayTemplates();
        });
    </script>
</body>
</html>
